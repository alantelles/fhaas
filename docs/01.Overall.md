# Overall

FhaaS is a REST webservice which provide actions for handle files providing tasks as copy, move, retrieve among others.

FhaaS uses JSON as data format for exchanging informations. All requests always expect JSON and return a JSON. The only exception is when trying to authorize a request, where you can specify a type that matches to your client application. It is useful when your application expect requests in other format.

## Requests specifications

### Methods

FhaaS tries always to be the most semantic possible and make good use of HTTP specifications. Because of it, a type of operation respond only to a specific method. The specifications are described below.

Operation|Method|Description
------|---|------
Copy|POST|Copy a file
Move| PUT |Move or rename a file 
Retrieve | GET|Get the content of a file
Digest | GET | Return a provided digest of a file
Directory replication | POST | Copy an entire directory to a another path
Directory listing | GET | Get the list of files in a directory

### Headers

FhaaS requests allow/require certain headers to succeed. Here are described which and function for each one. All of them are prefixed with `X-Fhaas-` which will be dropped from the table below.

Header|Function|Required
--------- | --- | ---
Auth-Token | A body that will be sent to authorization endpoint (more about authorization ahead). | true
Auth-Url | The endpoint to be used to authorize request if no url is set by other methods. | true if no other url is set
Auth-Content-Type | The content type for operation authorization request | false, defaults to **application/json**
Async | Specifies that the operation must be done asynchronously | true, for async requests
Send-Status-To | The endpoint to which the result of an async operation must be sent | false but highly recommended
Send-Status-To-Auth | A content which will be sent in `Authorization` header of send status request | false but if the `Send-Status-To` endpoint requires an authorization the request will fail

FhaaS send some headers in response which are useful for your application. All of them are prefixed with `X-Fhaas-` which will be dropped from the table below.

Header|Function
--- | ---
Request-Id|An unique identifier for each request. Typically a generic uuid.
Auth-Url-Used|The auhorization endpoint used for authorize a request. This is useful for verifying if requests were authorized by correct entity

### Body or query parameters

FhaaS follows HTTP specifications when requiring body or query parameters, that is, POST and PUT requests require a body, DELETE and GET don't.
The standard is that settings which can apply to every type of operation are sent in headers. Settings which is meaningful only to a type of operation are sent in body or query.

### Return codes

Again, HTTP specifications are taken account. 

Method|Status|Cause
--|--|--
POST|201|Everything was OK
A POST operation returns a 201 if all are ok.
A PUT operation returns a 200 if all are ok.
A DELETE operation returns 200, since some body is sent in response.
A operation with multiple files returns 207 if at least one was ok.
